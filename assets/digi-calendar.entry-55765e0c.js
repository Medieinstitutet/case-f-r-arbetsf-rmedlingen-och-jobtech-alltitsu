import{r as o,c as n,h as i}from"./index-40fbc463.js";import{r as g}from"./randomIdGenerator.util-17972493-3e0a24fb.js";import{d as h}from"./detectClickOutside.util-2e9cc8d8-d666b039.js";import{d as f}from"./detectFocusOutside.util-93fcba55-e3a25d95.js";import{l as u}from"./logger.util-9b5aeb0e-eecc5f5e.js";import{_ as r}from"./text-2fb6c0c4-138bda8d.js";import{i as s}from"./index-277dc6e0-cd8bfcb2.js";import{i as b,a as D}from"./index-7706e5cf-11bc5774.js";import"./detectClosest.util-903e8234-8e14c786.js";const m='.sc-digi-calendar-h{--digi--calendar--display:inline-block;--digi--calendar--header--font-family:var(--digi--global--typography--font-family--default);--digi--calendar--header--font-weight:var(--digi--global--typography--font-weight--semibold);--digi--calendar--header--display:flex;--digi--calendar--header--align-items:center;--digi--calendar--header--justify-content:space-between;--digi--calendar--header--text-align:center;--digi--calendar--header--button--padding:var(--digi--gutter--medium) var(--digi--gutter--largest);--digi--calendar--header--button--background:transparent;--digi--calendar--header--button--box-shadow:none;--digi--calendar--header--button--background--hover:var(--digi--global--color--cta--blue--dark);--digi--calendar--table--border-spacing:0;--digi--calendar--table--border-collapse:collapse;--digi--calendar--table--font-family:var(--digi--global--typography--font-family--default);--digi--calendar--table--font-weight:var(--digi--global--typography--font-weight--semibold);--digi--calendar--table-header--padding:var(--digi--gutter--larger) 0;--digi--calendar--table-header--font-weight-normal:var(--digi--typography--body--font-weight--desktop);--digi--calendar--date--border-color:none;--digi--calendar--date--box-shadow:none;--digi--calendar--date--box-shadow--hover:inset 0 0 0 var(--digi--border-width--primary) var(--digi--color--text--link);--digi--calendar--date--background-color:var(--digi--color--background--primary);--digi--calendar--date--background-color--hover:var(--digi--global--color--cta--blue--dark);--digi--calendar--date--padding:var(--digi--gutter--large);--digi--calendar--date--color:var(--digi--color--text--primary);--digi--calendar--date--focused--box-shadow:inset 0 0 0 var(--digi--border-width--primary) var(--digi--color--text--link);--digi--calendar--date--focused--background-color:var(--digi--global--color--cta--blue--dark);--digi--calendar--date--today--box-shadow:none;--digi--calendar--date--today--background-color:var(--digi--color--background--neutral-1);--digi--calendar--date--today--background-color--hover:var(--digi--global--color--cta--blue--dark);--digi--calendar--date--today--background-color--focused:var(--digi--global--color--cta--blue--dark);--digi--calendar--date--today--border-color:var(--digi--color--background--neutral-1);--digi--calendar--date--today--color:var(--digi--color--text--primary);--digi--calendar--date--today--circle-border:2px solid var(--digi--color--text--secondary);--digi--calendar--date--today--circle-margin:10%;--digi--calendar--date--selected--color:var(--digi--color--text--inverted);--digi--calendar--date--selected--background-color:var(--digi--color--background--complementary-1);--digi--calendar--week--font-style:italic;--digi--calendar--week--font-size:var(--digi--global--typography--font-size--small);--digi--calendar--week--border-color:var(--digi--color--background--neutral-3);--digi--calendar--week--border-width:var(--digi--border-width--primary)}.sc-digi-calendar-h .digi-calendar.sc-digi-calendar{display:var(--digi--calendar--display);background:var(--digi--calendar--header--button--background);padding:0px 1px 3px 1px}.sc-digi-calendar-h .digi-calendar--hide.sc-digi-calendar{--digi--calendar--display:none}.sc-digi-calendar-h .digi-calendar__header.sc-digi-calendar{display:var(--digi--calendar--header--display);align-items:var(--digi--calendar--header--align-items);justify-content:var(--digi--calendar--header--justify-content);text-align:var(--digi--calendar--header--text-align);font-size:var(--digi--global--typography--font-size--base);font-family:var(--digi--calendar--header--font-family);font-weight:var(--digi--calendar--header--font-weight)}.sc-digi-calendar-h .digi-calendar__header.sc-digi-calendar .digi-calendar__month-select-name.sc-digi-calendar{padding-inline:var(--digi--padding--smaller)}.sc-digi-calendar-h .digi-calendar__header.sc-digi-calendar .digi-calendar__month-select-button.sc-digi-calendar{font-family:inherit;font-size:inherit;font-weight:inherit;color:var(--digi--calendar--date--color);display:flex;align-items:center;background:var(--digi--calendar--header--button--background);border:var(--digi--calendar--date--box-shadow);padding:var(--digi--calendar--header--button--padding)}.sc-digi-calendar-h .digi-calendar__header.sc-digi-calendar .digi-calendar__month-select-button.sc-digi-calendar:last-child{border-radius:0 4px 0 0}.sc-digi-calendar-h .digi-calendar__header.sc-digi-calendar .digi-calendar__month-select-button.sc-digi-calendar:first-child{border-radius:4px 0 0 0}.sc-digi-calendar-h .digi-calendar__header.sc-digi-calendar .digi-calendar__month-select-button.sc-digi-calendar:focus,.sc-digi-calendar-h .digi-calendar__header.sc-digi-calendar .digi-calendar__month-select-button.sc-digi-calendar:hover{--digi--calendar--header--button--background:var(--digi--calendar--header--button--background--hover);text-decoration:underline;cursor:pointer}.sc-digi-calendar-h .digi-calendar__table.sc-digi-calendar{border-collapse:var(--digi--calendar--table--border-collapse);border-spacing:var(--digi--calendar--table--border-spacing);font-family:var(--digi--calendar--table--font-family);table-layout:fixed}.sc-digi-calendar-h .digi-calendar__table-header-week.sc-digi-calendar{font-style:italic;padding:var(--digi--calendar--table-header--padding);font-weight:var(--digi--calendar--table-header--font-weight-normal);width:50px}.sc-digi-calendar-h .digi-calendar__table-header.sc-digi-calendar{padding:var(--digi--calendar--table-header--padding);font-weight:var(--digi--calendar--table--font-weight);width:46px}.sc-digi-calendar-h .digi-calendar__td-week.sc-digi-calendar{border-right:var(--digi--calendar--week--border-width) solid var(--digi--calendar--week--border-color)}.sc-digi-calendar-h .digi-calendar__date--week-number.sc-digi-calendar{font-style:var(--digi--calendar--week--font-style);font-size:var(--digi--calendar--week--font-size);display:flex;align-items:center;justify-content:center}.sc-digi-calendar-h .digi-calendar__date--week-number.sc-digi-calendar:hover{cursor:default}.sc-digi-calendar-h .digi-calendar__date.sc-digi-calendar{position:relative;padding:var(--digi--calendar--date--padding);color:var(--digi--calendar--date--color);background-color:var(--digi--calendar--date--background-color);border-color:var(--digi--calendar--date--border-color);border-radius:var(--digi--border-radius--secondary);font-family:inherit;font-size:inherit;font-weight:inherit;text-align:center;border:none;width:44px;height:44px}.sc-digi-calendar-h .digi-calendar__date--disabled.sc-digi-calendar{--digi--calendar--date--color:transparent;pointer-events:none}.sc-digi-calendar-h .digi-calendar__date--today.sc-digi-calendar{position:relative}.sc-digi-calendar-h .digi-calendar__date--today.sc-digi-calendar::after{display:block;content:" ";position:absolute;top:var(--digi--calendar--date--today--circle-margin);bottom:var(--digi--calendar--date--today--circle-margin);left:var(--digi--calendar--date--today--circle-margin);right:var(--digi--calendar--date--today--circle-margin);border:var(--digi--calendar--date--today--circle-border);border-radius:50%}.sc-digi-calendar-h .digi-calendar__date.sc-digi-calendar:hover{--digi--calendar--date--box-shadow:var(--digi--calendar--date--box-shadow--hover);--digi--calendar--date--background-color:var(--digi--calendar--date--background-color--hover);cursor:pointer}.sc-digi-calendar-h .digi-calendar__date.sc-digi-calendar:hover span.sc-digi-calendar{text-decoration:underline}.sc-digi-calendar-h .digi-calendar__date--selected.sc-digi-calendar{--digi--calendar--date--background-color:var(--digi--calendar--date--selected--background-color);--digi--calendar--date--color:var(--digi--calendar--date--selected--color)}.sc-digi-calendar-h .digi-calendar__date--selected.sc-digi-calendar:hover{--digi--calendar--date--background-color:var(--digi--calendar--date--selected--background-color)}.sc-digi-calendar-h .digi-calendar__date--selected.sc-digi-calendar:hover span.sc-digi-calendar{text-decoration:none}.sc-digi-calendar-h .digi-calendar__date--not-selectable.sc-digi-calendar::after{display:block;content:" ";width:0px;height:100%;border:1px solid #757575;transform:rotate(-45deg);position:absolute;top:0%;left:50%}.sc-digi-calendar-h .digi-calendar__date--focused.sc-digi-calendar:focus-visible:not(.digi-calendar__date--selected){--digi--calendar--date--box-shadow:var(--digi--calendar--date--focused--box-shadow);--digi--calendar--date--background-color:var(--digi--calendar--date--focused--background-color)}',p=class{constructor(e){o(this,e),this.afOnDateSelectedChange=n(this,"afOnDateSelectedChange",7),this.afOnFocusOutside=n(this,"afOnFocusOutside",7),this.afOnClickOutside=n(this,"afOnClickOutside",7),this.afOnDirty=n(this,"afOnDirty",7),this.activeCalendar=[],this.selectedDates=[],this.months=[],this.focusedDate=void 0,this.dirty=!1,this.afId=g("digi-calendar"),this.afInitSelectedMonth=new Date().getMonth(),this.afInitSelectedDate=new Date,this.afShowWeekNumber=!1,this.afSelectedDate=void 0,this.afSelectedDates=[],this.afActive=!0,this.afMinDate=void 0,this.afMaxDate=void 0,this.afMultipleDates=!1}afSelectedDateChangeHandler(){s(this.afSelectedDate)?this.selectedDates=[this.afSelectedDate]:this.selectedDates=[]}afSelectedDatesChangeHandler(){this.afSelectedDates.length>0?this.afMultipleDates?this.afSelectedDates.find(e=>!s(e))||(this.selectedDates=this.afSelectedDates):s(this.afSelectedDates[0])&&(this.selectedDates=[this.afSelectedDates[0]]):this.selectedDates=[]}focusoutHandler(e){const a=e.target,t=`#${this.afId}-calendar`;f(a,t)&&this.afOnFocusOutside.emit(e)}clickHandler(e){const a=e.target,t=`#${this.afId}-calendar`;h(a,t)&&this.afOnClickOutside.emit(e)}drawCalendar(e){const a={year:e.getFullYear(),month:e.getMonth()};this.lastWeekOfPreviousMonth=this.getWeekDays(this.getLastDayOfPrevMonth(a)),this.firstWeekOfNextMonth=this.getWeekDays(this.getFirstDayOfNextMonth(a)),this.weeksBetween=this.getWeeksBetween(this.getLastDayOfPrevMonth(a),this.getFirstDayOfNextMonth(a)),this.weekDaysbetween=this.getWeekdaysOfMonth(this.weeksBetween),this.activeCalendar=this.appendFirstWeekOfNextMonth()?[this.lastWeekOfPreviousMonth,...this.weekDaysbetween,this.appendFirstWeekOfNextMonth()]:[this.lastWeekOfPreviousMonth,...this.weekDaysbetween],this.afShowWeekNumber&&this.activeCalendar.forEach((t,d)=>{this.activeCalendar[d].unshift(this.getWeekNumbers(t[0]))}),this.appendFirstWeekOfNextMonth()}appendFirstWeekOfNextMonth(){const e=JSON.stringify(this.weekDaysbetween.slice(-1)[0]),a=JSON.stringify(this.firstWeekOfNextMonth);if(this.firstWeekOfNextMonth.some(t=>this.isSameMonth(t,this.focusedDate))){if(e!==a)return this.firstWeekOfNextMonth}else return}getLastDayOfPrevMonth(e){return new Date(e.year,e.month,0)}getWeekDays(e){const a=e||new Date,t=[];for(let d=1;d<=7;d++){const l=a.getDate()-a.getDay()+d,c=new Date(a.setDate(l));t.push(c)}return t}getFirstDayOfNextMonth(e){return new Date(e.year,e.month+1,1)}getWeeksBetween(e,a){const d=e.getTime(),l=a.getTime(),c=Math.abs(l-d);return Math.floor(c/6048e5)}getWeekdaysOfMonth(e){let a=[];for(let t=1;t<=e;t++)a=[...a,this.getWeekDays(this.getUpcoming(t))];return a}getUpcoming(e){return new Date(this.focusedDate.getFullYear(),this.focusedDate.getMonth(),7*e)}onDirty(){this.dirty||(this.dirty=!0,this.afOnDirty.emit(this.dirty))}selectDateHandler(e){this.onDirty(),this.isDateSelectable(e)&&(this.isDateSelected(e)?this.selectedDates=this.afMultipleDates?this.selectedDates.filter(a=>!this.isSameDate(a,e)):[]:this.selectedDates=this.afMultipleDates?[...this.selectedDates,e]:[e],this.focusedDate=new Date(e),this.afOnDateSelectedChange.emit(this.selectedDates))}getMonthName(e){return new Date(1992,e,1).toLocaleDateString("default",{month:"short"}).replace(".","")}getFullMonthName(e){return new Date(this.focusedDate.getFullYear(),e,1).toLocaleDateString("default",{month:"long",year:"numeric"})}getWeekNumbers(e){let a=new Date(e);a.getTime(),a.setHours(0,0,0,0),a.setDate(a.getDate()+3-(a.getDay()+6)%7);var t=new Date(a.getFullYear(),0,4);return 1+Math.round(((a.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)}isSameMonth(e,a){return`${e.getFullYear()}${e.getMonth()}`==`${a.getFullYear()}${a.getMonth()}`}isSameDate(e,a){return this.getDateString(e)===this.getDateString(a)}getDateString(e){return`${e.getDate()}${e.getMonth()}${e.getFullYear()}`}isDateSelected(e){return!!this.selectedDates.find(a=>this.isSameDate(e,a))}isDateSelectable(e){return!(this.afMinDate&&this.isBefore(e,this.afMinDate)||this.afMaxDate&&this.isAfter(e,this.afMaxDate))}isBefore(e,a){return b(this.dateWithoutTime(e),this.dateWithoutTime(a))}isAfter(e,a){return D(this.dateWithoutTime(e),this.dateWithoutTime(a))}dateWithoutTime(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}isDisabledDate(e){return!this.isSameMonth(e,this.focusedDate)}subtractMonth(){let e=new Date(this.focusedDate);e.setMonth(e.getMonth()-1),this.afInitSelectedMonth=e.getMonth(),this.focusedDate=e}addMonth(){let e=new Date(this.focusedDate);e.setMonth(e.getMonth()+1),this.afInitSelectedMonth=e.getMonth(),this.focusedDate=e}getCurrent(e){return this.isSameDate(e,new Date)?"date":null}setTabIndex(e){return this.dirty?this.isSameDate(e,this.focusedDate)?0:-1:this.isSameMonth(e,new Date)?this.isSameDate(e,new Date)&&!this.isDisabledDate(e)?0:-1:this.isSameMonth(e,this.focusedDate)&&e.getDate()===1?0:-1}navigateHandler(e,a){if(e.detail&&e.detail.preventDefault(),e.detail.key==="Tab")return;this.onDirty();const t=new Date(e.detail.target.dataset.date);this.focusedDate=new Date(t.setDate(t.getDate()+a)),this.afInitSelectedMonth=this.focusedDate.getMonth(),this.resetFocus()}shiftTabHandler(){this._nextButton.focus()}resetFocus(){setTimeout(()=>{const e=this._tbody.querySelectorAll(".digi-calendar__date");if(e.length<=0){u.warn("Could not find an element with data-date attribute matching navigated date.",this._tbody);return}Array.from(e).map(a=>{let t=a;t.tabIndex=-1,t.classList.remove("digi-calendar__date--focused"),t.dataset.date===this.getFullDate(this.focusedDate)&&(t.focus(),t.tabIndex=0,t.classList.add("digi-calendar__date--focused"))})},100)}getFullDate(e){return e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})}getDateName(e){return e.toLocaleString("default",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}setFocused(e){return this.dirty?this.isSameDate(e,this.focusedDate):this.isSameMonth(e,new Date)?this.isSameDate(e,new Date)&&!this.isDisabledDate(e):this.isSameMonth(e,this.focusedDate)&&e.getDate()===1}ariaPressed(e){return this.selectedDates.length>0&&this.selectedDates.find(a=>this.isSameDate(a,e))?"true":"false"}componentWillLoad(){if(this.afInitSelectedDate)this.afInitSelectedMonth=this.afInitSelectedDate.getMonth(),this.focusedDate=this.afInitSelectedDate,this.drawCalendar(this.afInitSelectedDate);else{const e=new Date(new Date().getFullYear(),this.afInitSelectedMonth);this.focusedDate=e,this.drawCalendar(e)}}componentWillUpdate(){this.drawCalendar(this.focusedDate)}componentDidLoad(){s(this.afSelectedDate)?this.selectedDates=[this.afSelectedDate]:this.afSelectedDatesChangeHandler()}cssDateModifiers(e){return{"digi-calendar__date--today":this.isSameDate(e,new Date)&&!this.isDisabledDate(e),"digi-calendar__date--disabled":this.isDisabledDate(e),"digi-calendar__date--focused":this.setFocused(e),"digi-calendar__date--selected":this.isDateSelected(e),"digi-calendar__date--not-selectable":!this.isDisabledDate(e)&&!this.isDateSelectable(e)}}render(){return i("div",{class:{"digi-calendar":!0,"digi-calendar--hide":!this.afActive},id:`${this.afId}-calendar`},i("div",{class:"digi-calendar__header"},i("button",{class:"digi-calendar__month-select-button",type:"button","aria-label":this.getFullMonthName(this.afInitSelectedMonth-1)+", föregående månad",onClick:()=>this.subtractMonth()},i("digi-icon",{afName:"chevron-left",slot:"icon","aria-hidden":"true"}),i("span",{class:"digi-calendar__month-select-name"},this.getMonthName(this.afInitSelectedMonth-1))),i("div",{class:"digi-calendar__month"},this.getFullMonthName(this.afInitSelectedMonth)),i("button",{class:"digi-calendar__month-select-button",type:"button","aria-label":this.getFullMonthName(this.afInitSelectedMonth+1)+", nästa månad",onClick:()=>this.addMonth(),ref:e=>this._nextButton=e},i("span",{class:"digi-calendar__month-select-name"},this.getMonthName(this.afInitSelectedMonth+1)),i("digi-icon",{afName:"chevron-right",slot:"icon","aria-hidden":"true"}))),i("digi-util-keydown-handler",{onAfOnDown:e=>this.navigateHandler(e,7),onAfOnUp:e=>this.navigateHandler(e,-7),onAfOnLeft:e=>this.navigateHandler(e,-1),onAfOnRight:e=>this.navigateHandler(e,1),onAfOnShiftTab:()=>this.shiftTabHandler()},i("table",{role:"grid",class:"digi-calendar__table"},i("thead",null,i("tr",null,this.afShowWeekNumber&&i("th",{role:"gridcell",abbr:r.calendar.week,class:"digi-calendar__table-header-week"},r.calendar.week.toLowerCase()),Object.keys(r.calendar.weekdays).map(e=>i("th",{role:"gridcell",abbr:r.calendar.weekdays[e],class:"digi-calendar__table-header"},r.calendar.weekdays_short[e].toLowerCase())))),i("tbody",{ref:e=>this._tbody=e},this.activeCalendar.map(e=>i("tr",null,e.map((a,t)=>this.afShowWeekNumber&&t===0?i("td",{role:"gridcell",class:"digi-calendar__td-week"},i("div",{class:"digi-calendar__date--week-number"},i("span",{id:"digi-calendar__week-"+a,"aria-hidden":"true"},a))):i("td",{role:"gridcell",class:"digi-calendar__td"},i("button",{type:"button",class:Object.assign(Object.assign({},this.cssDateModifiers(a)),{"digi-calendar__date":!0}),onClick:()=>this.selectDateHandler(a),"aria-current":this.getCurrent(a),"aria-label":this.getDateName(a),"aria-disabled":this.isDisabledDate(a)||!this.isDateSelectable(a),"aria-describedby":this.afShowWeekNumber&&t===1?"digi-calendar__week-"+e[0]:null,tabindex:this.setTabIndex(a),"data-date":this.getFullDate(a),"aria-pressed":this.ariaPressed(a)},i("span",{"aria-hidden":"true"},a.getDate()))))))))),i("slot",{name:"calendar-footer"}))}static get watchers(){return{afSelectedDate:["afSelectedDateChangeHandler"],afSelectedDates:["afSelectedDatesChangeHandler"]}}};p.style=m;export{p as digi_calendar};
