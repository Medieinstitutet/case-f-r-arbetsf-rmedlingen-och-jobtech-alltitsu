import{r as T,d as r,h as d,H,g as C}from"./index-e970ef30.js";import{s as o,a as v,l as k,b as z,p as u,i as w,m as A,c as D,o as L,d as M,r as P}from"./linear-6a2614d1-19247fc9.js";import{r as O}from"./randomIdGenerator.util-17972493-3e0a24fb.js";function y(){var e=L().unknown(void 0),i=e.domain,t=e.range,s=0,a=1,n,h,c=!1,g=0,m=0,f=.5;delete e.unknown;function _(){var l=i().length,x=a<s,p=x?a:s,b=x?s:a;n=(b-p)/Math.max(1,l-g+m*2),c&&(n=Math.floor(n)),p+=(b-p-n*(l-g))*f,h=n*(1-g),c&&(p=Math.round(p),h=Math.round(h));var S=P(l).map(function(V){return p+n*V});return t(x?S.reverse():S)}return e.domain=function(l){return arguments.length?(i(l),_()):i()},e.range=function(l){return arguments.length?([s,a]=l,s=+s,a=+a,_()):[s,a]},e.rangeRound=function(l){return[s,a]=l,s=+s,a=+a,c=!0,_()},e.bandwidth=function(){return h},e.step=function(){return n},e.round=function(l){return arguments.length?(c=!!l,_()):c},e.padding=function(l){return arguments.length?(g=Math.min(1,m=+l),_()):g},e.paddingInner=function(l){return arguments.length?(g=Math.min(1,l),_()):g},e.paddingOuter=function(l){return arguments.length?(m=+l,_()):m},e.align=function(l){return arguments.length?(f=Math.max(0,Math.min(1,l)),_()):f},e.copy=function(){return y(i(),[s,a]).round(c).paddingInner(g).paddingOuter(m).align(f)},M.apply(_(),arguments)}const $=".sc-digi-bar-chart-h .digi-bar-chart.sc-digi-bar-chart{font-family:var(--digi--global--typography--font-family--default)}.sc-digi-bar-chart-h .chartTitle.sc-digi-bar-chart{--digi--typography--h2--margin:0.5rem;--digi--typography--h3--margin:0.5rem;--digi--typography--h4--margin:0.5rem;--digi--typography--h5--margin:0.5rem;--digi--typography--h6--margin:0.5rem;display:flex;justify-content:flex-start;flex-direction:column;align-items:left;text-align:left;padding-bottom:0.75rem;margin-right:0.5rem;flex-grow:2}.sc-digi-bar-chart-h .buttonWrapper.sc-digi-bar-chart{--digi--button--padding--medium:4px 4px 0.8125rem 0}.sc-digi-bar-chart-h .chartTooltip.sc-digi-bar-chart{box-sizing:border-box;position:absolute;background-color:rgba(250, 250, 250, 0.98);color:black;padding:5px 10px;padding-right:5px;border-radius:4px;display:flex;flex-direction:row;align-items:flex-start;box-shadow:rgba(60, 64, 67, 0.4) 0px 1px 2px 0px, rgba(60, 64, 67, 0.2) 0px 2px 6px 2px;font-size:0.875rem;display:none}.sc-digi-bar-chart-h .close.sc-digi-bar-chart{--digi--icon--color:black;cursor:pointer;margin-top:-5px}.sc-digi-bar-chart-h .legend.sc-digi-bar-chart::-webkit-scrollbar,.sc-digi-bar-chart-h .table.sc-digi-bar-chart::-webkit-scrollbar{height:10px;width:10px}.sc-digi-bar-chart-h .legend.sc-digi-bar-chart::-webkit-scrollbar-track,.sc-digi-bar-chart-h .table.sc-digi-bar-chart::-webkit-scrollbar-track{background:whitesmoke;border-radius:4px}.sc-digi-bar-chart-h .legend.sc-digi-bar-chart::-webkit-scrollbar-thumb,.sc-digi-bar-chart-h .table.sc-digi-bar-chart::-webkit-scrollbar-thumb{background-color:lightgray;border-radius:4px;border:0}.sc-digi-bar-chart-h .scChartStatus.sc-digi-bar-chart{border:0;clip:rect(1px, 1px, 1px, 1px);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap}.sc-digi-bar-chart-h .table.sc-digi-bar-chart{display:none;overflow-y:scroll;height:-moz-fit-content;height:fit-content;border-radius:4px;padding:0.25rem;background:linear-gradient(white 30%, rgba(255, 255, 255, 0)) center top, linear-gradient(rgba(255, 255, 255, 0), white 70%) center bottom, radial-gradient(farthest-side at 50% 0, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0)) center top, radial-gradient(farthest-side at 50% 100%, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0)) center bottom;background-repeat:no-repeat;background-size:100% 40px, 100% 40px, 100% 14px, 100% 14px;background-attachment:local, local, scroll, scroll}.sc-digi-bar-chart-h .topWrapper.sc-digi-bar-chart{display:flex;flex-direction:row;align-items:flex-end;justify-content:space-between;flex-wrap:wrap}",B=class{constructor(e){T(this,e),this._dims={},this._margin={bottom:0,top:5,left:5,right:15,ellipsis:!1},this.tickPadding=8,this.yTickSize=0,this.xTickSize=5,this._tickWidth=1,this.defaultDuration=400,this.fontSize="0.875rem",this.barChartObserver=new ResizeObserver(i=>{i.forEach(()=>{this.resize()})}),this.tableObserver=new ResizeObserver(i=>{i.forEach(()=>{o(this._legendDiv).style("width",this._dims.width+"px"),this.resizeTable()})}),this.setTickInteraction=()=>{this.afVariation===r.Horizontal?this._yAxisHandle.selectAll("text").style("cursor","pointer").on("click",this.openTooltip).on("mouseenter",this.hover).on("mouseleave",this.hoverOut):this._xAxisHandle.selectAll("text").style("cursor","pointer").on("click",this.openTooltip).on("mouseenter",this.hover).on("mouseleave",this.hoverOut)},this.setYScale=()=>{this.afVariation==r.Horizontal?(this._yScale=y(this._chartData.data.xValueNames,[this._margin.top,this._dims.height-this._margin.bottom]).paddingOuter(.1).paddingInner(.1),this._yAxis=v(this._yScale)):(this._yScale=k().domain([this._minVal,this._maxVal]).nice(3),this._yScale.range([this._dims.height-this._margin.bottom,this._margin.top]),this._yAxis=v(this._yScale))},this.setXScale=()=>{this.afVariation==r.Horizontal?(this._xScale=k().domain([this._minVal,this._maxVal]).nice(3),this._margin.right=this.getTextSize(this._xScale.domain()[1].toLocaleString())/2+this.yTickSize+this.tickPadding,this._xScale.range([0,this._dims.width-this._margin.right-this._margin.left]),this._xAxis=z(this._xScale),this._tickWidth=this.getLargestText(this._xScale.ticks().map(i=>i.toLocaleString()))):(this._xScale=y(this._chartData.data.xValueNames,[0,this._dims.width-this._margin.right-this._margin.left]).paddingOuter(.1).paddingInner(.1),this._xAxis=z(this._xScale))},this.tickSizes=()=>{this._namedTickSizes=[],this._ellipsisSize=this.getTextSize("...");for(let i=0;i<this._chartData.data.xValueNames.length;i++)this._namedTickSizes.push(Math.ceil(this.getTextSize(this._chartData.data.xValueNames[i])))},this.updateBars=()=>{this._barChartContainer.selectAll(".barGroup").data(this.reshapeData).join(i=>{var t;const s=i.append("g").attr("class","barGroup").attr("id",a=>"barGroup"+a.key.replace(/[^A-Z0-9]+/ig,"_"));return s.append("rect").attr("class","bar").style("cursor","pointer").attr("ry",4).attr("rx",4).attr("y",a=>this.afVariation===r.Horizontal?this._yScale(a.key):this._dims.height-this._margin.bottom).attr("x",a=>this.afVariation===r.Horizontal?2:this._xScale(a.key)).attr("width",()=>this.afVariation===r.Horizontal?0:this._xScale.bandwidth()).attr("height",()=>this.afVariation===r.Horizontal?this._yScale.bandwidth():0).on("mouseenter",this.hover).on("mouseleave",this.hoverOut).on("click",this.openTooltip).transition().duration(this.defaultDuration).ease(u).attr("width",a=>this.afVariation===r.Horizontal?this._xScale(a.value):this._xScale.bandwidth()).attr("y",a=>this.afVariation===r.Horizontal?this._yScale(a.key):this._yScale(a.value)).attr("height",a=>this.afVariation===r.Horizontal?this._yScale.bandwidth():this._dims.height-this._margin.bottom-this._yScale(a.value)).attr("fill","#00005a"),!((t=this._chartData.meta)===null||t===void 0)&&t.valueLabels&&s.append("text").text(a=>a.value.toLocaleString()).attr("class","barText").attr("font-size",this.fontSize).attr("font-weight","600").attr("text-anchor","end").style("pointer-events","none").attr("y",a=>this.afVariation===r.Horizontal?this._yScale(a.key)+this._yScale.bandwidth()/2:this._dims.height-this._margin.bottom).attr("x",a=>this.afVariation===r.Horizontal?2:this._xScale(a.key)+this._xScale.bandwidth()/2).transition().duration(this.defaultDuration).ease(u).attr("font-size",this.fontSize).attr("font-weight","600").attr("x",a=>this.afVariation===r.Horizontal?this._xScale(a.value):this._xScale(a.key)+this._xScale.bandwidth()/2).attr("y",a=>this.afVariation===r.Horizontal?this._yScale(a.key)+this._yScale.bandwidth()/2:this._yScale(a.value)).attr("text-anchor",a=>this.afVariation===r.Vertical?"middle":this._xScale(a.value)<a.len+this.tickPadding*2?"start":"end").attr("dx",a=>this.afVariation===r.Horizontal?this._xScale(a.value)<a.len+this.tickPadding*2?this.tickPadding:-this.tickPadding:0).attr("fill",a=>this.afVariation===r.Vertical||this._xScale(a.value)<a.len+this.tickPadding*2?"black":"white").attr("dy",()=>this.afVariation==r.Horizontal?"0.35em":"-0.25em").style("pointer-events","none").attrTween("text",(a,n,h)=>{const c=parseFloat(h[n].textContent.replace(/\s/g,""))?parseFloat(h[n].textContent.replace(/\s/g,"")):0;let g=w(c,a.value);return m=>h[n].textContent=parseInt(g(m)).toLocaleString(void 0,this._numberFormat)}),s},i=>(i.select("rect").transition().duration(this.defaultDuration).ease(u).attr("y",t=>this.afVariation===r.Horizontal?this._yScale(t.key):this._yScale(t.value)).attr("x",t=>this.afVariation===r.Horizontal?2:this._xScale(t.key)).attr("width",t=>this.afVariation===r.Horizontal?this._xScale(t.value):this._xScale.bandwidth()).attr("height",t=>this.afVariation===r.Horizontal?this._yScale.bandwidth():this._dims.height-this._margin.bottom-this._yScale(t.value)).attr("fill","#00005a"),i.select("text").style("display",()=>{var t;return!((t=this._chartData.meta)===null||t===void 0)&&t.valueLabels?null:"none"}).transition().duration(this.defaultDuration).ease(u).attr("font-size",this.fontSize).attr("font-weight","600").attr("y",t=>this.afVariation===r.Horizontal?this._yScale(t.key)+this._yScale.bandwidth()/2:this._yScale(t.value)).attr("x",t=>this.afVariation===r.Horizontal?this._xScale(t.value):this._xScale(t.key)+this._xScale.bandwidth()/2).attr("text-anchor",t=>this.afVariation===r.Vertical?"middle":this._xScale(t.value)<t.len+this.tickPadding*2?"start":"end").attr("dx",t=>this.afVariation===r.Horizontal?this._xScale(t.value)<t.len+this.tickPadding*2?this.tickPadding:-this.tickPadding:0).attr("fill",t=>this.afVariation===r.Vertical||this._xScale(t.value)<t.len+this.tickPadding*2?"black":"white").attr("dy",()=>this.afVariation==r.Horizontal?"0.35em":"-0.25em").style("pointer-events","none").attrTween("text",(t,s,a)=>{const n=parseFloat(a[s].textContent.replace(/\s/g,""))?parseFloat(a[s].textContent.replace(/\s/g,"")):0;let h=w(n,t.value);return c=>a[s].textContent=parseInt(h(c)).toLocaleString(void 0,this._numberFormat)})),i=>i.remove()),this._barSelection=this._barChartContainer.selectAll("rect"),this._textSelection=this._barChartContainer.selectAll(".barText")},this.adjustBarText=()=>{var i;!((i=this._chartData.meta)===null||i===void 0)&&i.valueLabels&&this._textSelection.attr("y",t=>this.afVariation===r.Horizontal?this._yScale(t.key)+this._yScale.bandwidth()/2:this._yScale(t.value)).attr("x",t=>this.afVariation===r.Horizontal?this._xScale(t.value):this._xScale(t.key)+this._xScale.bandwidth()/2).attr("dx",t=>this.afVariation===r.Horizontal?this._xScale(t.value)<t.len+this.tickPadding*2?this.tickPadding:-this.tickPadding:0).attr("fill",t=>this.afVariation===r.Vertical||this._xScale(t.value)<t.len+this.tickPadding*2?"black":"white").attr("text-anchor",t=>this.afVariation===r.Vertical?"middle":this._xScale(t.value)<t.len+this.tickPadding*2?"start":"end")},this.reshapeData=()=>{let i=[];return this._chartData.data.xValueNames.forEach((t,s)=>{i.push({key:t,value:this._chartData.data.series[0].yValues[s],len:this.getTextSize(this._chartData.data.series[0].yValues[s].toLocaleString())})}),i},this.adjustBarSize=()=>{this._barSelection.attr("y",i=>this.afVariation===r.Horizontal?this._yScale(i.key):this._yScale(i.value)).attr("x",i=>this.afVariation===r.Horizontal?2:this._xScale(i.key)).attr("width",i=>this.afVariation===r.Horizontal?this._xScale(i.value):this._xScale.bandwidth()).attr("height",i=>this.afVariation===r.Horizontal?this._yScale.bandwidth():this._dims.height-this._margin.bottom-this._yScale(i.value))},this.resizeTable=()=>{this.setDims(),this.setTableDimensions()},this.setDims=(i=!1)=>{const t=o(this._titleDiv).node().getBoundingClientRect(),s=o(this._legendDiv).node().getBoundingClientRect(),a=this._dims.height;return i||(this._dims=o(this._chartDiv).node().getBoundingClientRect()),this._dims.height=this._maxHeight-s.height-t.height-1.75*this._rem,a!=this._dims.height},this.setMargins=()=>{this._pixelSize=Number(window.getComputedStyle(document.body).getPropertyValue("font-size").match(/\d+/)[0])*Number(this.fontSize.replace(/[^\d.]|\.(?=.*\.)/g,"")),this.afVariation===r.Horizontal?this._margin.left=this.getLargestText(this._chartData.data.xValueNames):this._margin.left=this.getLargestText([this._minVal.toLocaleString(),this._maxVal.toLocaleString()]),this._margin.left>this._dims.width/4?(this._margin.left=Math.floor(this._dims.width/4),this._margin.ellipsis=!0):this._margin.ellipsis=!1,this._margin.bottom=this._pixelSize+this.tickPadding+this.xTickSize},this.setNamedTicks=(i=!1)=>{if(this.afVariation==r.Horizontal)i?this._yAxisHandle.style("font-size",this.fontSize).style("font-family","Open Sans").transition().duration(this.defaultDuration).call(this._yAxis.tickPadding(this.tickPadding).tickSize(this.yTickSize).tickSizeOuter(0).tickFormat((t,s)=>{if(!this._margin.ellipsis)return t;const a=this._namedTickSizes[s]+this.tickPadding+this.yTickSize,n=this._margin.left;if(a<n)return t;const h=this.getTextSize(t.slice(0,Math.max(Math.floor(n/(a+this._ellipsisSize)*t.length),3))+"...");let c=0;return h>n&&(c=Math.ceil((h-n)/(a/t.length))),t.slice(0,Math.max(Math.floor(n/(a+this._ellipsisSize)*t.length)-c,3))+"..."})):this._yAxisHandle.style("font-size",this.fontSize).style("font-family","Open Sans").call(this._yAxis.tickPadding(this.tickPadding).tickSize(this.yTickSize).tickSizeOuter(0).tickFormat((t,s)=>{if(!this._margin.ellipsis)return t.toLocaleString();const a=this._namedTickSizes[s]+this.tickPadding+this.yTickSize,n=this._margin.left;if(a<n)return t.toLocaleString();const h=this.getTextSize(t.slice(0,Math.max(Math.floor(n/(a+this._ellipsisSize)*t.length),3))+"...");let c=0;return h>n&&(c=Math.ceil((h-n)/(a/t.length))),t.slice(0,Math.max(Math.floor(n/(a+this._ellipsisSize)*t.length)-c,3))+"..."}));else{const t=(this._dims.width-this._margin.left-this._margin.right)/this._chartData.data.xValues.length;i?this._xAxisHandle.style("font-size",this.fontSize).style("font-family","Open Sans").transition().duration(this.defaultDuration).call(this._xAxis.tickPadding(this.tickPadding).tickSize(this.xTickSize).tickSizeOuter(0).tickFormat((s,a)=>s.slice(0,Math.max(Math.floor(t/(this._namedTickSizes[a]+this._ellipsisSize+5)*s.length),3))+"...")):this._xAxisHandle.style("font-size",this.fontSize).style("font-family","Open Sans").call(this._xAxis.tickPadding(this.tickPadding).tickSize(this.xTickSize).tickSizeOuter(0).tickFormat((s,a)=>s.slice(0,Math.max(Math.floor(t/(this._namedTickSizes[a]+this._ellipsisSize+5)*s.length),3))+"...")),this._xAxisHandle.selectAll("text").attr("transform","rotate(15)")}},this.setValueTicks=(i=!1)=>{if(this._chartData.meta&&this._chartData.meta.hideXAxis){this.afVariation===r.Horizontal?this._xAxisHandle.attr("display","none"):this._yAxisHandle.attr("display","none");return}let t,s,a;this.afVariation===r.Horizontal?(this._xAxisHandle.attr("display",null),t=this._xAxis,s=-(this._dims.height-this._margin.top-this._margin.bottom),a=this._xAxisHandle):(this._yAxisHandle.attr("display",null),t=this._yAxis,s=-(this._dims.width-this._margin.left-this._margin.right),a=this._yAxisHandle);const n=Math.min(Math.floor((this._dims.width-this._margin.left-this._margin.right)/(this._tickWidth+this.xTickSize))-2,this.afVariation==r.Horizontal?this._xScale.ticks().length:this._yScale.ticks().length);i?a.style("font-size",this.fontSize).style("font-family","Open Sans").transition("newScale").duration(this.defaultDuration).call(t.ticks(this.afVariation===r.Horizontal?Math.max(2,Math.min(n,9)):5).tickPadding(this.tickPadding).tickSize(s).tickSizeOuter(0).tickFormat(h=>h.toLocaleString())):a.style("font-size",this.fontSize).style("font-family","Open Sans").call(t.ticks(this.afVariation===r.Horizontal?Math.max(2,Math.min(n,9)):5).tickPadding(this.tickPadding).tickSize(s).tickSizeOuter(0).tickFormat(h=>h.toLocaleString())),a.selectAll("line").attr("stroke","lightgray"),this.afVariation===r.Vertical&&this._yAxisHandle.select(".domain").attr("display","none")},this.hover=i=>{o(i.target).transition("hover").duration(20).attr("fill",i.target.tagName==="rect"?"#4C4C8B":"var(--digi--color--text--link-hover)")},this.hoverOut=i=>{o(i.target).transition("hover").duration(this.defaultDuration).attr("fill",i.target.tagName==="rect"?"#00005a":"#333333")},this.openTooltip=(...[,i])=>{typeof i=="string"?this._tooltipData=this._barChartContainer.select(`#barGroup${i.replace(/[^A-Z0-9]+/ig,"_")}`).datum():this._tooltipData=i;let t=this._tooltip.select(".tooltipBody");t.select(this._tooltipHeading).style("margin","0 0.75rem 0 0 ").style("font-weight",500).html(this._tooltipData.key),t.selectAll("div").data([this._tooltipData]).join("div").style("display","flex").style("flex-direction","row").style("flex-wrap","nowrap").style("white-space","nowrap").style("justify-content","space-between").html(s=>s.value.toLocaleString()),this._tooltip.style("display","flex"),this.positionTooltip(this._tooltipData)},this.closeTooltip=()=>{this._tooltip.style("display","none")},this.positionTooltip=i=>{const t=this._tooltip.node().getBoundingClientRect().width,s=this._tooltip.node().getBoundingClientRect().height+8,a=this._xScale(i.value)/2-t/2;this.afVariation===r.Horizontal?(this._tooltip.style("transform",`translate(${this._margin.left+this.tickPadding+Math.max(a,-4)}px, ${this._yScale(i.key)+this._yScale.bandwidth()+this._yScale.paddingInner()*this._yScale.bandwidth()}px )`).style("max-width",this._xScale.range()[1]+"px"),this._tooltip.select("digi-icon-caret-up").style("position","absolute").style("--digi--icon--color","white").style("top","-11px").style("left","0").style("transform",`translate(${a>0?t/2-10:this._xScale(i.value)/2}px,0)`)):(this._tooltip.style("transform",`translate(${this._margin.left+this.tickPadding+this._xScale(i.key)+this._xScale.bandwidth()/2-t/2}px, ${this._yScale(i.value)-s}px )`).style("max-width",this._xScale.range()[1]+"px"),this._tooltip.select("digi-icon-caret-down").style("position","absolute").style("--digi--icon--color","white").style("left","0").style("bottom","-11px").style("transform",`translate(${t/2-6}px,0)`))},this.recomputeTextSize=()=>{var i;this.afVariation==r.Horizontal&&(this._tickWidth=this.getLargestText(this._xScale.ticks().map(t=>t.toLocaleString()))),this.tickSizes(),this._barChartContainer.selectAll(".barGroup").data(this.reshapeData),!((i=this._chartData.meta)===null||i===void 0)&&i.valueLabels&&this._textSelection.remove(),this.initBarText()},this.activateTable=i=>{this.closeTooltip(),this.barChartObserver.disconnect(),this.tableObserver.observe(this._chartDiv),this._status.innerHTML="<p>Visas som tabell</p>",o(this._host).select(".tableButton").style("display","none"),o(this._host).select(".chartButton").style("display",null),i.target.nextSibling.lastChild.focus();const t=150;this._svg.attr("opacity",1).transition("fadeout").duration(t).attr("opacity",0).on("end",()=>{this._svg.remove(),this._legendDiv.style.display="none",this._tableDiv.style.display="block",this.setTableContent(),this.setTableDimensions(),o(this._tableDiv).style("opacity",0).transition("fadein").duration(t).style("opacity",1)}),o(this._legendDiv).style("opacity",1).transition("fadeout").duration(t).style("opacity",0)},this.reInitChart=i=>{this.tableObserver.disconnect(),this._status.innerHTML="<p>Visas som diagram</p>",o(this._host).select(".tableButton").style("display",null),o(this._host).select(".chartButton").style("display","none"),i.target.previousSibling.lastChild.focus();const t=o(this._tableDiv);t.style("opacity",1).transition().duration(150).style("opacity",0).on("end",()=>{t.style("display","none"),this.initChain(),this._svg.attr("opacity",0).transition().duration(150).attr("opacity",1)})},this.afVariation=r.Vertical,this.afHeadingLevel="h3",this.afId=O("tooltip"),this.afChartData=void 0}afChartDataUpdate(e){typeof e!="string"?this._chartData=e:this._chartData=JSON.parse(e)}initSvg(){var e,i,t,s;this._numberFormat={maximumSignificantDigits:(i=(e=this._chartData.meta)===null||e===void 0?void 0:e.labelProperties)===null||i===void 0?void 0:i.significantDigits,notation:!((s=(t=this._chartData.meta)===null||t===void 0?void 0:t.labelProperties)===null||s===void 0)&&s.shortHand?"compact":"standard"},o(this._chartDiv).select("svg").remove(),this._maxHeight=o(this._host).node().parentNode.getBoundingClientRect().height,this.barChartObserver.observe(this._chartDiv),this._rem=parseFloat(getComputedStyle(document.documentElement).fontSize),this.setMinMax(),this.setDims(),this.setMargins(),this._svg=o(this._chartDiv).append("svg").attr("aria-hidden",!0).attr("role","img").attr("aria-label",this._chartData&&this._chartData.title?"Stapeldiagram om "+this._chartData.title.toLowerCase():"Stapeldiagram"),this._svg.attr("width",this._dims.width).attr("height",this._dims.height),this._tooltip=o("#"+this.afId),this._tooltip.select(".close").on("click",this.closeTooltip),this._tooltipHeading="h"+(parseInt(this.afHeadingLevel.replace(/\D/g,""))+1),this._tooltip.selectAll(".tooltipBody").append(this._tooltipHeading).attr("class","tooltipHeading").style("font-size","1rem").style("margin","0 0.75rem").style("font-weight","500")}initYAxis(){this.setYScale(),this._barChartContainer=this._svg.append("g").attr("transform",`translate(${this._margin.left+this.tickPadding+this.yTickSize},0)`),this._yAxisHandle=this._barChartContainer.append("g"),this.afVariation===r.Horizontal?(this.tickSizes(),this.setNamedTicks(),this.setTickInteraction()):this.setValueTicks()}setMinMax(){this._maxVal=A(this._chartData.data.series[0].yValues),this._minVal=D([0,D(this._chartData.data.series[0].yValues)])}initXAxis(){this.setXScale(),this._xAxisHandle=this._barChartContainer.append("g").attr("transform",`translate(0,${this._dims.height-this._margin.bottom})`),this.afVariation===r.Horizontal?(this.setValueTicks(),this._xAxisHandle.select(".tick").select("line").remove()):(this.tickSizes(),this.setNamedTicks(),this.setTickInteraction())}initBars(){this._barSelection=this._barChartContainer.selectAll("barGroup").data(this.reshapeData).join("g").attr("class","barGroup").attr("id",e=>"barGroup"+e.key.replace(/[^A-Z0-9]+/ig,"_")).append("rect").attr("class","bar").style("cursor","pointer"),this._barSelection.attr("y",e=>this.afVariation===r.Horizontal?this._yScale(e.key):this._yScale(e.value)).attr("x",e=>this.afVariation===r.Horizontal?2:this._xScale(e.key)).attr("ry",4).attr("rx",4).attr("width",e=>this.afVariation===r.Horizontal?this._xScale(e.value):this._xScale.bandwidth()).attr("height",e=>this.afVariation===r.Horizontal?this._yScale.bandwidth():this._dims.height-this._margin.bottom-this._yScale(e.value)).attr("fill","#00005a").on("mouseenter",this.hover).on("mouseleave",this.hoverOut).on("click",this.openTooltip)}initBarText(){this._textSelection=this._barChartContainer.selectAll(".barGroup").append("text"),this._textSelection.text(e=>e.value.toLocaleString(void 0,this._numberFormat)).attr("class","barText").attr("font-size",this.fontSize).attr("font-weight","600").attr("text-anchor","end").attr("y",e=>this.afVariation===r.Horizontal?this._yScale(e.key)+this._yScale.bandwidth()/2:this._yScale(e.value)).attr("x",e=>this.afVariation===r.Horizontal?this._xScale(e):this._xScale(e.key)+this._xScale.bandwidth()).attr("dy",()=>this.afVariation==r.Horizontal?"0.35em":"-0.25em").style("pointer-events","none").style("display",()=>{var e;return!((e=this._chartData.meta)===null||e===void 0)&&e.valueLabels?null:"none"}),this.adjustBarText()}initChain(){this.initSvg(),this.initYAxis(),this.initXAxis(),this.initBars(),this.initBarText()}async updateChain(){var e,i,t,s;if(this._numberFormat={maximumSignificantDigits:(i=(e=this._chartData.meta)===null||e===void 0?void 0:e.labelProperties)===null||i===void 0?void 0:i.significantDigits,notation:!((s=(t=this._chartData.meta)===null||t===void 0?void 0:t.labelProperties)===null||s===void 0)&&s.shortHand?"compact":"standard"},this.closeTooltip(),this._tableDiv.style.display=="block")this.setTableContent(),this.setTableDimensions();else{this.barChartObserver.disconnect(),this.setMinMax();const a=this.setDims();this._svg.attr("width",this._dims.width).attr("height",this._dims.height).attr("aria-label",this._chartData&&this._chartData.title?"Stapeldiagram om "+this._chartData.title.toLowerCase():"Stapeldiagram"),this.setMargins(),this._barChartContainer.transition("position").duration(this.defaultDuration).ease(u).attr("transform",`translate(${this._margin.left+this.tickPadding+this.yTickSize})`).on("end",()=>this.barChartObserver.observe(this._chartDiv)),a&&(this.afVariation===r.Horizontal?this._yScale.range([this._margin.top,this._dims.height-this._margin.bottom]):this._yScale.range([this._dims.height-this._margin.bottom,this._margin.top]),this._xAxisHandle.attr("transform",`translate(0,${this._dims.height-this._margin.bottom})`)),this.tickSizes(),this.setYScale(),this.setXScale(),this.setNamedTicks(!0),this.setTickInteraction(),this._tickWidth=this.getLargestText(this.afVariation==r.Horizontal?this._xScale.ticks().map(n=>n.toLocaleString()):this._yScale.ticks().map(n=>n.toLocaleString())),this.setValueTicks(!0),this._xAxisHandle.select(".tick").select("line").remove(),this.updateBars()}}resize(){const e=this.setDims();this.setMargins(),this._svg.attr("width",this._dims.width).attr("height",this._dims.height),this._barChartContainer.attr("transform",`translate(${this._margin.left+this.tickPadding+this.yTickSize},0)`),this._margin.right=this.getTextSize(this._xScale.domain()[1].toLocaleString())/2+this.yTickSize+this.tickPadding,e&&(this.afVariation===r.Horizontal?this._yScale.range([this._margin.top,this._dims.height-this._margin.bottom]):this._yScale.range([this._dims.height-this._margin.bottom,this._margin.top]),this._xAxisHandle.attr("transform",`translate(0,${this._dims.height-this._margin.bottom})`)),this._xScale.range([0,this._dims.width-this._margin.right-this._margin.left]),this.setNamedTicks(),this.setValueTicks(),this.adjustBarSize(),this.adjustBarText(),this._tooltipData&&this.positionTooltip(this._tooltipData)}getLargestText(e){let i=0;return e.forEach(t=>{const s=this.getTextSize(t);s>i&&(i=s)}),i}componentWillLoad(){this.afChartDataUpdate(this.afChartData)}componentDidLoad(){this.initChain(),document.fonts.ready.then(()=>{this.recomputeTextSize(),this.setNamedTicks(),this._barChartContainer.attr("transform",`translate(${this._margin.left+this.tickPadding+this.yTickSize},0)`)})}componentWillUpdate(){}componentDidUpdate(){this.updateChain()}getTextSize(e){var i=[];let t=o(this._chartDiv).append("svg");return t.selectAll("dummyText").data([e]).join("text").attr("font-size",this.fontSize).text(s=>s).each((...[,s,a])=>{var n=a[s].getComputedTextLength();i.push(n),a[s].remove()}),t.remove().exit(),i[0]}setTableContent(){this._tableDiv.innerHTML=`<digi-table af-size="small" af-variation="primary"> <table><caption>${this._chartData.title}</caption><thead><tr>${this.headings()}</tr></thead><tbody>${this.tableBody()}</tbody></table></digi-table>`}setTableDimensions(){const e=o(this._tableDiv);e.style("height",this._dims.height+"px"),e.style("width",this._dims.width-this._rem*.65+"px")}headings(){let e=`<th scope="col">${this._chartData.x}</th>`;return this._chartData.data.series.forEach(i=>{e=e.concat(`<th scope="col">${i.title}</th>`)}),e}tableBody(){let e="";return(this._chartData.data.xValueNames?this._chartData.data.xValueNames:this._chartData.data.xValues).forEach((t,s)=>{let a="";this._chartData.data.series.forEach(n=>{a=a.concat(`<td>${n.yValues[s]!=null?n.yValues[s].toLocaleString():"-"}</td>`)}),e=e.concat(`<tr><th scope='row'>${t}${a}</th></tr>`)}),e}render(){let e="";return this._chartData.subTitle?this._chartData.infoText?e=`<${this.afHeadingLevel}>${this._chartData.title}</${this.afHeadingLevel}><p>${this._chartData.subTitle}
				<span style="display:block;margin-top:0.25rem;font-size:0.875rem;color:var(--digi--global--color--neutral--grayscale--darkest-3)">${this._chartData.infoText}</span></p>`:e=`<${this.afHeadingLevel}>${this._chartData.title}</${this.afHeadingLevel}><p>${this._chartData.subTitle}</p>`:e=`<${this.afHeadingLevel}>${this._chartData.title}</${this.afHeadingLevel}>`,d(H,{ref:i=>this._host=i},d("div",{class:"topWrapper",ref:i=>this._titleDiv=i},d("digi-typography",{class:"chartTitle",innerHTML:e}),d("digi-button",{class:"buttonWrapper tableButton","af-size":"medium","af-variation":"function","af-full-width":"false",onAfOnClick:this.activateTable},d("digi-icon-table",{slot:"icon"}),"Visa tabell"),d("digi-button",{style:{display:"none"},class:"buttonWrapper chartButton","af-size":"medium","af-variation":"function","af-full-width":"false",onAfOnClick:this.reInitChart},d("digi-icon-chart",{slot:"icon"}),"Visa diagram"),d("div",{class:"scChartStatus",role:"status",ref:i=>this._status=i})),d("div",{class:"chartTooltip",id:this.afId},d("div",{class:"tooltipBody"}),d("digi-icon-x",{class:"close"}),this.afVariation===r.Horizontal?d("digi-icon-caret-up",null):d("digi-icon-caret-down",null)),d("div",{ref:i=>this._chartDiv=i}," "),d("div",{class:"legend",ref:i=>this._legendDiv=i}),d("div",{class:"table",ref:i=>this._tableDiv=i}," "))}get hostElement(){return C(this)}static get watchers(){return{afChartData:["afChartDataUpdate"]}}};B.style=$;export{B as digi_bar_chart};
